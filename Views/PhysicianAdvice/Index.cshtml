@{
    ViewData["Title"] = "Advice & Prescription";
    var pending = ViewBag.Pending as List<MediClinic.Models.AdviceListVM>;
    var completed = ViewBag.Completed as List<MediClinic.Models.AdviceListVM>;
}

<div class="phys-container">

    <h2 class="phys-title">Advice & Prescription</h2>
    <p class="phys-subtitle">Write advice and manage prescriptions for your patients</p>

    <!-- Pending -->
    <div class="phys-card phys-section">
        <h4 class="fw-bold mb-3">Pending for Advice</h4>

        <div class="phys-table-wrap">
            <table class="table phys-table">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Time</th>
                        <th>Patient</th>
                        <th>Criticality</th>
                        <th>Reason</th>
                        <th>Status</th>
                        <th style="width:200px;">Action</th>

                    </tr>
                </thead>

                <tbody>
                    @if (pending != null && pending.Count > 0)
                    {
                        foreach (var item in pending)
                        {
                            <tr>
                                <td>@item.ScheduleDate</td>
                                <td>@item.ScheduleTime</td>
                                <td>@item.PatientName</td>
                                <td>@item.Criticality</td>
                                <td>@item.Reason</td>
                                <td><span class="badge-soft badge-confirmed">Confirmed</span></td>

                                <td>
                                    <a class="btn btn-teal"
                                       href="/PhysicianAdvice/Write?scheduleId=@item.ScheduleId">
                                        Write Advice
                                    </a>
                                </td>
                                <td>
                                    <a class="btn btn-info btn-sm"
                                       href="/Physician/PatientDetails?patientID=@item.PatientId">
                                        Patient Details
                                    </a>
                                </td>
                            </tr>
                        }
                    }
                    else
                    {
                        <tr>
                            <td colspan="7" class="text-center text-muted py-4">
                                No pending appointments
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>

    <!-- Completed -->
    <div class="phys-card phys-section">
        <h4 class="fw-bold mb-3">Completed Appointments</h4>

        <div class="phys-table-wrap">
            <table class="table phys-table">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Time</th>
                        <th>Patient</th>
                        <th>Criticality</th>
                        <th>Reason</th>
                        <th>Status</th>
                        <th style="width:320px;">Action</th>
                    </tr>
                </thead>

                <tbody>
                    @if (completed != null && completed.Count > 0)
                    {
                        foreach (var item in completed)
                        {
                            <tr>
                                <td>@item.ScheduleDate</td>
                                <td>@item.ScheduleTime</td>
                                <td>@item.PatientName</td>
                                <td>@item.Criticality</td>
                                <td>@item.Reason</td>
                                <td><span class="badge-soft badge-completed">Completed</span></td>

                                <td>
                                    <a class="btn btn-soft btn-soft-blue"
                                       href="/PhysicianAdvice/ViewAdvice?scheduleId=@item.ScheduleId">
                                        View Advice
                                    </a>

                                    <a class="btn btn-soft btn-soft-amber ms-2"
                                       href="/PhysicianAdvice/EditAdvice?scheduleId=@item.ScheduleId">
                                        Edit
                                    </a>

                                    @if (item.PhysicianAdviceId != null && item.PhysicianAdviceId > 0)
                                    {
                                        <a class="btn btn-soft btn-soft-dark ms-2"
                                           href="/Prescription/View?physicianAdviceId=@item.PhysicianAdviceId">
                                            Prescription
                                        </a>
                                    }
                                </td>
                            </tr>
                        }
                    }
                    else
                    {
                        <tr>
                            <td colspan="7" class="text-center text-muted py-4">
                                No completed appointments
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>

        <div class="mt-3">
            <a class="btn btn-outline-teal" href="/Physician/Dashboard">Back</a>
        </div>
    </div>

</div>
