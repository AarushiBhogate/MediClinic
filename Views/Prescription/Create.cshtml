@using MediClinic.Models
@{
    Layout = "~/Views/Shared/_DashboardLayout.cshtml";
    ViewData["Title"] = "Add Prescription";

    var advice = ViewBag.Advice as PhysicianAdvice;
    var drugs = ViewBag.Drugs as List<SelectListItem>;
}

<div class="phys-container">

    <!-- Standard Header -->
    <div class="phys-header-fixed">
        <div class="d-flex justify-content-between align-items-center">

            <div>
                <h2 class="phys-title mb-1">Add Prescription</h2>
                <p class="phys-subtitle mb-0">
                    Add medicines for this appointment
                </p>
            </div>

            <a class="btn btn-back" href="/Physician/Dashboard">
                <i class="bi bi-arrow-left"></i> Back
            </a>

        </div>
    </div>

    <div class="phys-card">

        <!-- Appointment Info -->
        <div class="phys-info-grid mb-4">
            <div class="phys-info-item">
                <div class="phys-info-label">Patient</div>
                <div class="phys-info-value">
                    @(advice?.Schedule?.Appointment?.Patient?.PatientName ?? "N/A")
                </div>
            </div>

            <div class="phys-info-item">
                <div class="phys-info-label">Date</div>
                <div class="phys-info-value">
                    @(advice?.Schedule?.ScheduleDate?.ToString() ?? "N/A")
                </div>
            </div>

            <div class="phys-info-item">
                <div class="phys-info-label">Time</div>
                <div class="phys-info-value">
                    @(advice?.Schedule?.ScheduleTime ?? "N/A")
                </div>
            </div>
        </div>

        <div class="phys-divider"></div>

        <!-- Form -->
        <form asp-action="Create" method="post">

            <input type="hidden"
                   name="physicianAdviceId"
                   value="@advice?.PhysicianAdviceId" />

            <div class="mb-3">
                <label class="fw-semibold mb-2">Drug</label>
                <select class="form-control phys-input"
                        name="drugId"
                        required>
                    <option value="">-- Select Drug --</option>
                    @if (drugs != null && drugs.Count > 0)
                    {
                        foreach (var d in drugs)
                        {
                            <option value="@d.Value">@d.Text</option>
                        }
                    }
                </select>
            </div>

            <div class="mb-3">
                <label class="fw-semibold mb-2">Dosage</label>
                <input class="form-control phys-input"
                       name="dosage"
                       placeholder="e.g. 1 tablet twice a day"
                       required />
            </div>

            <div class="mb-3">
                <label class="fw-semibold mb-2">Prescription</label>
                <input class="form-control phys-input"
                       name="prescription"
                       placeholder="e.g. After meals for 5 days"
                       required />
            </div>

            <div class="d-flex gap-3 mt-4">
                <button type="submit"
                        class="btn btn-teal">
                    Add Medicine
                </button>

                <a asp-action="View"
                   asp-route-physicianAdviceId="@advice?.PhysicianAdviceId"
                   class="btn btn-outline-teal">
                    View Prescription
                </a>

                <a asp-controller="PhysicianAdvice"
                   asp-action="Index"
                   class="btn btn-outline-teal">
                    Cancel
                </a>
            </div>

        </form>

    </div>
</div>
